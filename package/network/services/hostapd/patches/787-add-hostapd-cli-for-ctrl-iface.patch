--- a/hostapd/ctrl_iface.c
+++ b/hostapd/ctrl_iface.c
@@ -1663,6 +1663,27 @@ static int hostapd_ctrl_iface_get(struct
 	return -1;
 }
 
+#ifdef CONFIG_DRIVER_SIFLOWER
+static int hostapd_ctrl_sf_iface_enable(struct hostapd_data *hapd)
+{
+	hapd->sf_enable_set_beacon = true;
+	if (ieee802_11_set_beacon(hapd)) {
+		wpa_printf(MSG_ERROR, "Enabling of sf interface failed");
+		return -1;
+	}
+	return 0;
+}
+
+static int hostapd_ctrl_sf_iface_disable(struct hostapd_data *hapd)
+{
+	if (hostapd_drv_stop_ap(hapd)) {
+		wpa_printf(MSG_ERROR, "Disabling of sf interface failed");
+		return -1;
+	}
+	hapd->sf_enable_set_beacon = false;
+	return 0;
+}
+#endif
 
 static int hostapd_ctrl_iface_enable(struct hostapd_iface *iface)
 {
@@ -3748,7 +3769,11 @@ static int hostapd_ctrl_iface_receive_pr
 		reply_len = hostapd_ctrl_iface_get(hapd, buf + 4, reply,
 						   reply_size);
 	} else if (os_strncmp(buf, "ENABLE", 6) == 0) {
+#ifdef CONFIG_DRIVER_SIFLOWER
+		if (hostapd_ctrl_sf_iface_enable(hapd))
+#else
 		if (hostapd_ctrl_iface_enable(hapd->iface))
+#endif
 			reply_len = -1;
 	} else if (os_strcmp(buf, "RELOAD_WPA_PSK") == 0) {
 		if (hostapd_ctrl_iface_reload_wpa_psk(hapd))
@@ -3757,7 +3782,11 @@ static int hostapd_ctrl_iface_receive_pr
 		if (hostapd_ctrl_iface_reload(hapd->iface))
 			reply_len = -1;
 	} else if (os_strncmp(buf, "DISABLE", 7) == 0) {
+#ifdef CONFIG_DRIVER_SIFLOWER
+		if (hostapd_ctrl_sf_iface_disable(hapd))
+#else
 		if (hostapd_ctrl_iface_disable(hapd->iface))
+#endif
 			reply_len = -1;
 	} else if (os_strcmp(buf, "UPDATE_BEACON") == 0) {
 		if (ieee802_11_set_beacon(hapd))
--- a/src/ap/beacon.c
+++ b/src/ap/beacon.c
@@ -1807,7 +1807,11 @@ static int __ieee802_11_set_beacon(struc
 	struct wpabuf *beacon, *proberesp, *assocresp;
 	int res, ret = -1;
 
-	if (!hapd->drv_priv) {
+	if (!hapd->drv_priv
+#ifdef CONFIG_DRIVER_SIFLOWER
+			|| !hapd->sf_enable_set_beacon
+#endif
+			) {
 		wpa_printf(MSG_ERROR, "Interface is disabled");
 		return -1;
 	}
--- a/src/ap/hostapd.c
+++ b/src/ap/hostapd.c
@@ -2625,6 +2625,9 @@ struct hostapd_iface * hostapd_init(stru
 					       conf->bss[i]);
 		if (hapd == NULL)
 			goto fail;
+#ifdef CONFIG_DRIVER_SIFLOWER
+		hapd->sf_enable_set_beacon = true;
+#endif
 		hapd->msg_ctx = hapd;
 	}
 
--- a/src/ap/hostapd.h
+++ b/src/ap/hostapd.h
@@ -450,6 +450,9 @@ struct hostapd_data {
 #ifdef CONFIG_CTRL_IFACE_UDP
        unsigned char ctrl_iface_cookie[CTRL_IFACE_COOKIE_LEN];
 #endif /* CONFIG_CTRL_IFACE_UDP */
+#ifdef CONFIG_DRIVER_SIFLOWER
+	bool sf_enable_set_beacon;
+#endif
 };
 
 
--- a/hostapd/Makefile
+++ b/hostapd/Makefile
@@ -223,6 +223,10 @@ endif
 endif
 endif
 
+ifdef CONFIG_DRIVER_SIFLOWER
+CFLAGS += -DCONFIG_DRIVER_SIFLOWER
+endif
+
 ifdef CONFIG_NO_CTRL_IFACE
 CFLAGS += -DCONFIG_NO_CTRL_IFACE
 else
